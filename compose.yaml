# version: '3.8' # Use a recent Docker Compose file format

services:
  backend:
    build: ./backend # Build from the Dockerfile in the ./backend directory
    command: python manage.py runserver 0.0.0.0:8000 # Command to run Django
    volumes:
      - ./backend:/app # Mount your local backend code into the container for live updates
      - ./backend/db.sqlite3:/app/db.sqlite3 # <--- IMPORTANT: Persist SQLite DB
    ports:
      - "8000:8000" # Expose Django port to your host machine
    # Remove 'depends_on' and 'environment' related to PostgreSQL
    # If you had environment variables for PostgreSQL, remove them.
    environment:
      DJANGO_SETTINGS_MODULE: CAS.settings # Replace with your actual settings module

  frontend:
    build: ./frontend # Build from the Dockerfile in the ./frontend directory
    volumes:
      - ./frontend:/app # Mount frontend code for development
    ports:
      - "80:80" # Expose Nginx port (for serving built Vue app) to your host
    # depends_on: # You can keep this if you want to ensure backend starts first, but not strictly necessary for SQLite.
    #   - backend